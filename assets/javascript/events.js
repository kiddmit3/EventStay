var artist;var clientId="&client_id=ODM4NTkyM3wxNTAxNzgxMjczLjM5";$("#eventResults").hide();var lat;var lon;var newList;var checkArray=[];var pickedCover="assets/images/"+Math.floor((Math.random()*6)+1)+".jpg";$('#coverImg').attr("src",pickedCover);$('#searchText').select();function findEvent(events){$("#no-event").empty();var queryURL="https://api.seatgeek.com/2/events?performers.slug="+artist+clientId;$.ajax({url:queryURL,method:"GET"}).done(function(response2){$(".result").remove();console.log("Number of Events Returned: "+response2.events.length);if(response2.events.length===0){$("#no-event").append("No scheduled event(s) found.");}for(var i=0;i<response2.events.length;i++){var object=response2.events[i];lat=object.venue.location.lat;lon=object.venue.location.lon;var eventName=object.title;var tickets=$("<a>").attr("class","tickets").attr("href",object.url).html("<i class='fas fa-ticket-alt fa-5x'></i><p>SeatGeek Tickets");tickets.attr("target","_blank");var eventDate=moment(object.datetime_utc).format("MM/DD/YYYY");var eventCity=object.venue.display_location;newList=$("<li>");var newEvent=$("<div>");$(newEvent).addClass("collapsible-header result");$(newEvent).attr("data-Index",i);$(newEvent).attr("lat",lat);$(newEvent).attr("lon",lon);var col1=$("<span>");$(col1).addClass("col s10");$(col1).append(eventName+"<br/>"+eventCity+"<br/>"+eventDate+"<br/>");var hotelList=$("<p>").attr("class","hotel-font").html("<i class='fas fa-h-square'></i> Click here for a list of local hotels from HotWire");$(col1).append(hotelList);var col2=$("<span>");$(col2).addClass("col s4");col2.append(tickets);newEvent.append(col1,col2);var body=$("<div>");$(body).addClass("collapsible-body clearfix");$(body).attr("id","body"+i)
newList.append(newEvent,body);$("#eventResults").append(newList);};});};function findArtist(artist){$("#band-name").empty();$("#band-image").attr("src","assets/images/noimage.jpg");var queryURL1="https://api.seatgeek.com/2/performers?slug="+artist+clientId;$.ajax({url:queryURL1,method:"GET"}).done(function(response){var artistName=response.performers[0].short_name;var bandImage=response.performers[0].image;console.log("Band Image: "+bandImage);console.log(response.performers[0]);$("#band-name").append(artistName);if(bandImage===null){$("#band-image").attr("src","assets/images/noimage.jpg");}else{$("#band-image").attr("src",bandImage);}});};$("#search").submit(function(event){$("#eventResults").show();event.preventDefault();checkArray=[];$(".collapsible-body").remove();artist=$("#searchText").val().toLowerCase().trim().split(" ").join("-");console.log("Artist is: "+artist);findEvent(event);if(artist!==""){findArtist(artist);}else{$("#band-name").empty();$("#band-image").attr("src","assets/images/concert2.jpg");}});$(document).on("click",".result",function(){var body=$("<div>");$(body).addClass("collapsible-body clearfix");var lon=$(this).attr("lon");var lat=$(this).attr("lat");var id=$(this).attr("data-Index");var hotelRooms=["assets/images/room1.jpg","assets/images/room2.jpg","assets/images/room3.jpg","assets/images/room4.jpg","assets/images/room5.jpg"]
var queryURL="https://hotwire.herokuapp.com/v1/deal/hotel?format=json&apikey=yh4ypdrga68t9ansnt795c2j&limit=10&dest=="+lat+","+lon+"&distance=*~30&starrating=4~*&sort=price&sortorder=asc";if(checkArray.indexOf(id)===-1){checkArray.push(id);$.ajax({url:queryURL,method:"GET"}).done(function(response){for(var i=0;i<5;i++){console.log(response);var object2=JSON.parse(response);console.log(object2);var price=object2.Result[i].Price;var hotelURL=object2.Result[i].Url;var starRating=object2.Result[i].StarRating;var savingsPercentage=object2.Result[i].SavingsPercentage;var city=object2.Result[i].City;var state=object2.Result[i].StateCode;var Neighborhood=object2.Result[i].Neighborhood;var nights=object2.Result[i].NightDuration;console.log(price,city,state);var hotelImg=$("<span>");$(hotelImg).addClass("col s4");$(hotelImg).attr("id","hotelImg");var hotelPic=$("<img>");hotelPic.attr("src",hotelRooms[i]);hotelPic.attr("id","hotelPic");hotelImg.append(hotelPic)
var hotelArea=$("<span>");$(hotelArea).addClass("col s8");$(hotelArea).attr("id","hotelinfo")
hotelArea.append("<b>"+Neighborhood+"</b><br/>");hotelArea.append(city+", "+state);hotelArea.append("<br/>Rating: "+starRating+" &#9734;&#9734;&#9734;&#9734;")
hotelArea.append("<br/>"+"<a href='"+hotelURL+"'target='_blank'>Hotwire LINK</a>");var priceInfo=$("<span>");$(priceInfo).addClass("col s2");$(priceInfo).attr("id","hotelPrices");priceInfo.append("<h2>$"+Math.trunc(price)+"</h2><br/>Per Night</h1><br/>A "+savingsPercentage+"% Discount");var row=$("<div>");$(row).addClass("row valign-wrapper");row.append(hotelImg,hotelArea,priceInfo);console.log(id);$("#body"+id).append(row);};});}else{console.log("Stop double-clicking");}});